select distinct(p.email) from parent p inner join parent_location p_l on p.email = p_l.parent_email inner join child c on p.child_id = c.child_id inner join child_interest c_l on c.child_id = c_l.child_id  where location_id in (select location_id from location where name = 'Arizona' or name = 'Scottsdale') or interest_id in (select interest_id from interest where name = 'Video Games' or name = 'Reading') or cancer_type = 'Acute myeloid leukemia';

select parent_email email, group_concat(l.name separator ',') locations from location l inner join parent_location p_l on l.location_id = p_l.location_id where parent_email in ('armaan_reet@gmail.com','vipul.sarin@gmail.com') group by parent_email; 

select p.email, group_concat(i.name separator ',') interests from interest i inner join child_interest c_i on i.interest_id = c_i.interest_id inner join parent p on p.child_id = c_i.child_id where c_i.child_id in (select child_id from parent where email in ('armaan_reet@gmail.com','vipul.sarin@gmail.com')) group by p.email; 

select parent_email,group_concat(l.name separator ',') locations from location l inner join parent_location p_l on l.location_id = p_l.location_id where parent_email in (select distinct(p.email) from parent p inner join parent_location p_l on p.email = p_l.parent_email inner join child c on p.child_id = c.child_id inner join child_interest c_l on c.child_id = c_l.child_id  where location_id in (select location_id from location where name = 'Arizona' or name = 'Scottsdale') or interest_id in (select interest_id from interest where name = 'Video Games' or name = 'Reading') or cancer_type = 'Acute myeloid leukemia') group by parent_email;

select interests.email, locations, interests from (select parent_email email, group_concat(l.name separator ',') locations from location l inner join parent_location p_l on l.location_id = p_l.location_id where parent_email in ('armaan_reet@gmail.com','vipul.sarin@gmail.com') group by parent_email ) as loc inner join (select p.email, group_concat(i.name separator ',') interests from interest i inner join child_interest c_i on i.interest_id = c_i.interest_id inner join parent p on p.child_id = c_i.child_id where c_i.child_id in (select child_id from parent where email in ('armaan_reet@gmail.com','vipul.sarin@gmail.com')) group by p.email) as interests on interests.email = loc.email;

select l.email, l.locations, group_concat(i.name separator ',') interests from (select parent_email email,group_concat(l.name separator ',') locations from location l inner join parent_location p_l on l.location_id = p_l.location_id where parent_email in (select distinct(p.email) from parent p inner join parent_location p_l on p.email = p_l.parent_email inner join child c on p.child_id = c.child_id inner join child_interest c_l on c.child_id = c_l.child_id  where location_id in (select location_id from location where name = 'Arizona' or name = 'Scottsdale') or interest_id in (select interest_id from interest where name = 'Video Games' or name = 'Reading') or cancer_type = 'Acute myeloid leukemia') group by parent_email) as l inner join parent p on l.email = p.email inner join child_interest c_i on c_i.child_id = p.child_id inner join interest i on i.interest_id = c_i.interest_id group by l.email;

select l.email, p.firstname, p.lastname, c.cancer_type, l.locations, group_concat(i.name separator ',') interests from (select parent_email email,group_concat(l.name separator ',') locations from location l inner join parent_location p_l on l.location_id = p_l.location_id where parent_email in (select distinct(p.email) from parent p inner join parent_location p_l on p.email = p_l.parent_email inner join child c on p.child_id = c.child_id inner join child_interest c_l on c.child_id = c_l.child_id  where location_id in (select location_id from location where name in ('Scottsdale')) or interest_id in (select interest_id from interest where name in ('Basketball')) or cancer_type in ('Hodgkin lymphoma')) group by parent_email) as l inner join parent p on l.email = p.email inner join child_interest c_i on c_i.child_id = p.child_id inner join interest i on i.interest_id = c_i.interest_id inner join child c on c.child_id = p.child_id group by l.email;



